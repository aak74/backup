# Backup удаленного bitrix-проекта на локальную машину

## Краткое описание
Скрипт предназначен для создания снапшота текущего состояния сайта. Снапшот включает в себя файлы из папки сайта и дамп БД. Данные для подключения к БД скрипт получает из файла `./bitrix/.settings.php`.

Инициатором создания бэкапа является локальный компьютер. Все настройки происходят на локальном компьютере. Количество сайтов, которые может бэкапить скрипт, ничем не ограничено. Для добавления сайта необходимо в папке `config` создать файл вида:
```php
<?php
return array_merge(
    require_once('default.php'),
    [
        'host' => 'example.com',
        'user' => 'bitrix',
        'port' => '2222',
        'path' => '/var/www/html',
        'name' => 'example',
        'dump_name' => 'db.sql',
    ]
);
```
Файл необходимо назвать `project.php`, где `project` это имя проекта.

Для создания бэкапа просто запустите:
```
php run.php project
```
Где `project` это имя проекта

## Установка
Backup делается через ssh. Рекомендуется сгенерировать ssh ключ `ssh-keygen`. И записать публичный ключ на удаленный сервер `ssh-copy-id`.

На некоторых серверах нельзя сохранить ssh ключ. Поэтому доступ туда возможен только с помощью пароля. Для backup с помощью пароля нужно дополнительно установить:
```
sudo apt-get install sshpass
```
